!function(t){function e(e){return"".trim?e.val().trim():t.trim(e.val())}t.fn.isHappy=function(n){function i(t){return!!(t&&t.constructor&&t.call&&t.apply)}function s(e){var i=n.classes&&n.classes.message||"unhappyMessage";return t('<span id="'+e.id+'" class="'+i+'" role="alert">'+e.message+"</span>")}function r(t){return i(n.errorTemplate)?n.errorTemplate(t):s(t)}function a(){var t,e,s=!1;for(t=0,e=p.length;e>t;t+=1)p[t].testValid(!0)||(s=!0);return s?(i(n.unHappy)&&n.unHappy(),!1):n.testMode?(i(n.happy)&&n.happy(),window.console&&console.warn("would have submitted"),!1):(i(n.happy)&&n.happy(),void 0)}function u(){c=!1}function o(){c=!0,t(window).bind("mouseup",u)}function l(s,a){var u=t(a),o={message:s.message||"",id:a.slice(1)+"_unhappy"},l=t(o.id).length>0?t(o.id):r(o),d=function(){c?t(window).bind("mouseup",u.testValid.bind(this)):u.testValid()};p.push(u),u.testValid=function(r){var a,o,d,p=t(this),c=!1,h=!!p.get(0).attributes.getNamedItem("required")||s.required,m="password"===u.attr("type"),f=i(s.arg)?s.arg():s.arg,g=n.classes&&n.classes.field||"unhappy";return a=i(s.clean)?s.clean(p.val()):!m&&"undefined"==typeof s.trim||s.trim?e(p):p.val(),p.val(a),o=(a.length>0||"sometimes"===h)&&i(s.test),r===!0&&h===!0&&0===a.length?c=!0:o&&(c=!s.test(a,f)),c?(p.addClass(g).after(l),!1):(d=l.get(0),d.parentNode&&d.parentNode.removeChild(d),p.removeClass(g),!0)},u.bind(s.when||n.when||"blur",d)}var d,p=[],c=!1;for(d in n.fields)l(n.fields[d],d);return t(n.submitButton||this).bind("mousedown",o),n.submitButton?t(n.submitButton).click(a):this.bind("submit",a),this}}(this.jQuery||this.Zepto);var happy={USPhone:function(t){return/^\(?(\d{3})\)?[\- ]?\d{3}[\- ]?\d{4}$/.test(t)},date:function(t){return/^(?:0[1-9]|1[0-2])\/(?:0[1-9]|[12][0-9]|3[01])\/(?:\d{4})/.test(t)},email:function(t){return/^(?:\w+\.?\+?)*\w+@(?:\w+\.)+\w+$/.test(t)},minLength:function(t,e){return t.length>=e},maxLength:function(t,e){return t.length<=e},equal:function(t,e){return t==e}};